<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScaleStartup - Configuration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            animation: fadeIn 1s ease-in;
        }

        .logo {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #fff 0%, #888 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-text {
            font-size: 32px;
            margin-bottom: 20px;
            font-weight: 300;
        }

        .subtitle {
            font-size: 18px;
            color: #888;
            margin-bottom: 60px;
            font-weight: 300;
        }

        .start-btn {
            background: #fff;
            color: #000;
            border: none;
            padding: 18px 60px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255,255,255,0.3);
        }

        /* Form Screens */
        .form-screen {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .form-screen.active {
            display: block;
        }

        .form-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .form-title {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 15px;
        }

        .form-subtitle {
            font-size: 16px;
            color: #888;
        }

        .progress-bar {
            height: 4px;
            background: #222;
            border-radius: 2px;
            margin-bottom: 40px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #fff;
            transition: width 0.5s ease;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .required {
            color: #ff4444;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 15px 20px;
            background: #111;
            border: 2px solid #333;
            color: #fff;
            font-size: 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #fff;
            background: #1a1a1a;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-select {
            cursor: pointer;
        }

        .form-select option {
            background: #111;
            color: #fff;
        }

        /* Co-founders Section */
        .cofounder-item {
            background: #111;
            border: 2px solid #222;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            position: relative;
        }

        .cofounder-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .cofounder-title {
            font-size: 18px;
            font-weight: 600;
        }

        .remove-btn {
            background: #ff4444;
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            background: #ff0000;
        }

        .add-cofounder-btn {
            background: transparent;
            color: #fff;
            border: 2px dashed #444;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .add-cofounder-btn:hover {
            border-color: #fff;
            background: #111;
        }

        /* File Upload */
        .file-upload {
            position: relative;
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: block;
            padding: 40px;
            background: #111;
            border: 2px dashed #444;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            border-color: #fff;
            background: #1a1a1a;
        }

        .file-preview {
            margin-top: 20px;
            text-align: center;
        }

        .file-preview img {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            border: 2px solid #333;
        }

        /* Buttons */
        .form-actions {
            display: flex;
            gap: 20px;
            margin-top: 50px;
        }

        .btn {
            flex: 1;
            padding: 18px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: #fff;
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255,255,255,0.3);
        }

        .btn-secondary {
            background: transparent;
            color: #fff;
            border: 2px solid #444;
        }

        .btn-secondary:hover {
            border-color: #fff;
            background: #111;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Completion Screen */
        .completion-screen {
            display: none;
            text-align: center;
            animation: fadeIn 1s ease-in;
        }

        .completion-screen.active {
            display: block;
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 30px;
        }

        .completion-title {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 20px;
        }

        .completion-text {
            font-size: 18px;
            color: #888;
            margin-bottom: 50px;
        }

        /* Error Messages */
        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo {
                font-size: 36px;
            }

            .welcome-text {
                font-size: 24px;
            }

            .form-title {
                font-size: 28px;
            }

            .form-actions {
                flex-direction: column;
            }
        }

        /* Loading Spinner */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid #333;
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div class="welcome-screen active" id="welcomeScreen">
            <div class="logo">ScaleStartup</div>
            <h1 class="welcome-text">Welcome to Your Journey</h1>
            <p class="subtitle">Let's build something extraordinary together</p>
            <button class="start-btn" onclick="startConfiguration()">Get Started</button>
        </div>

        <!-- Step 1: Founder Details -->
        <div class="form-screen" id="founderScreen">
            <div class="progress-bar">
                <div class="progress-fill" style="width: 33%"></div>
            </div>
            <div class="form-header">
                <h2 class="form-title">Founder Profile</h2>
                <p class="form-subtitle">Tell us about yourself and your team</p>
            </div>

            <form id="founderForm">
                <div class="form-group">
                    <label class="form-label">Location <span class="required">*</span></label>
                    <input type="text" class="form-input" id="location" placeholder="City, State, Country" required>
                    <div class="error-message" id="locationError">Location is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Languages You Speak <span class="required">*</span></label>
                    <input type="text" class="form-input" id="languages" placeholder="e.g., English, Hindi, Spanish" required>
                    <div class="error-message" id="languagesError">Languages are required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Your Age <span class="required">*</span></label>
                    <input type="number" class="form-input" id="userAge" placeholder="25" required>
                    <div class="error-message" id="ageError">Age is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Graduation/Education <span class="required">*</span></label>
                    <input type="text" class="form-input" id="graduation" placeholder="e.g., B.Tech in Computer Science" required>
                    <div class="error-message" id="graduationError">Education is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Awards & Recognition</label>
                    <textarea class="form-textarea" id="awards" placeholder="List any awards or recognition you've received"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Experience in Field <span class="required">*</span></label>
                    <textarea class="form-textarea" id="experience" placeholder="Describe your relevant experience" required></textarea>
                    <div class="error-message" id="experienceError">Experience is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Co-Founders</label>
                    <div id="cofoundersContainer"></div>
                    <button type="button" class="add-cofounder-btn" onclick="addCofounder()">+ Add Co-Founder</button>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="goToWelcome()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="saveFounderDetails()">Next Step</button>
                </div>
            </form>
        </div>

        <!-- Step 2: Startup Profile -->
        <div class="form-screen" id="startupScreen">
            <div class="progress-bar">
                <div class="progress-fill" style="width: 66%"></div>
            </div>
            <div class="form-header">
                <h2 class="form-title">Create Your Startup Profile</h2>
                <p class="form-subtitle">Tell us about your venture</p>
            </div>

            <form id="startupForm">
                <div class="form-group">
                    <label class="form-label">Startup Name <span class="required">*</span></label>
                    <input type="text" class="form-input" id="startupName" placeholder="Enter your startup name" required>
                    <div class="error-message" id="startupNameError">Startup name is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Year of Establishment <span class="required">*</span></label>
                    <input type="number" class="form-input" id="yearEstablished" placeholder="2024" min="1900" max="2026" required>
                    <div class="error-message" id="yearError">Year is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Country <span class="required">*</span></label>
                    <input type="text" class="form-input" id="country" placeholder="e.g., India" required>
                    <div class="error-message" id="countryError">Country is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">State <span class="required">*</span></label>
                    <input type="text" class="form-input" id="state" placeholder="e.g., Maharashtra" required>
                    <div class="error-message" id="stateError">State is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">City <span class="required">*</span></label>
                    <input type="text" class="form-input" id="city" placeholder="e.g., Mumbai" required>
                    <div class="error-message" id="cityError">City is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Startup Logo</label>
                    <div class="file-upload">
                        <input type="file" class="file-input" id="logoInput" accept="image/*" onchange="previewLogo(event)">
                        <label for="logoInput" class="file-label">
                            <div>üìÅ Click to upload logo</div>
                            <div style="font-size: 12px; color: #666; margin-top: 10px;">PNG, JPG up to 5MB</div>
                        </label>
                        <div class="file-preview" id="logoPreview"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Category <span class="required">*</span></label>
                    <select class="form-select" id="category" required>
                        <option value="">Select a category</option>
                        <option value="AgTech">AgTech (Agriculture Technology)</option>
                        <option value="AdTech">AdTech (Advertising Technology)</option>
                        <option value="AI/ML">AI/ML (Artificial Intelligence & Machine Learning)</option>
                        <option value="Aerospace">Aerospace (Space exploration and satellites)</option>
                        <option value="AutoTech">AutoTech (Automotive and autonomous driving)</option>
                        <option value="BioTech">BioTech (Biology-based innovation)</option>
                        <option value="Blockchain">Blockchain (Decentralized ledgers and crypto)</option>
                        <option value="B2B SaaS">B2B SaaS (Business-to-Business Software)</option>
                        <option value="CleanTech">CleanTech (Environmentally friendly tech)</option>
                        <option value="Cybersecurity">Cybersecurity (Data protection and safety)</option>
                        <option value="ClimateTech">ClimateTech (Addressing global warming)</option>
                        <option value="EdTech">EdTech (Education and online learning)</option>
                        <option value="E-commerce">E-commerce (Online retail)</option>
                        <option value="FinTech">FinTech (Financial services)</option>
                        <option value="FoodTech">FoodTech (Food production and delivery)</option>
                        <option value="GameTech">GameTech (Video games and engines)</option>
                        <option value="HealthTech">HealthTech (Hospital and medical systems)</option>
                        <option value="InsurTech">InsurTech (Insurance innovation)</option>
                        <option value="IoT">IoT (Internet of Things/connected devices)</option>
                        <option value="LegalTech">LegalTech (Automating law services)</option>
                        <option value="Logistics">Logistics (Supply chain and shipping)</option>
                        <option value="MarTech">MarTech (Marketing automation)</option>
                        <option value="MedTech">MedTech (Medical devices and hardware)</option>
                        <option value="PropTech">PropTech (Property and Real Estate)</option>
                        <option value="SaaS">SaaS (Software as a Service)</option>
                        <option value="SpaceTech">SpaceTech (Rocketry and satellite data)</option>
                        <option value="TravelTech">TravelTech (Booking and tourism)</option>
                        <option value="VR/AR">VR/AR (Virtual and Augmented Reality)</option>
                        <option value="Web3">Web3 (Decentralized internet)</option>
                        <option value="Other">Other</option>
                    </select>
                    <div class="error-message" id="categoryError">Category is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Startup Stage <span class="required">*</span></label>
                    <select class="form-select" id="stage" required>
                        <option value="">Select startup stage</option>
                        <option value="Idea">Idea</option>
                        <option value="Building">Building</option>
                        <option value="MVP">MVP</option>
                        <option value="Pre-Launch">Pre-Launch</option>
                        <option value="Growing">Growing</option>
                        <option value="Scale">Scale</option>
                    </select>
                    <div class="error-message" id="stageError">Stage is required</div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="goToFounder()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="saveStartupProfile()">Next Step</button>
                </div>
            </form>
        </div>

        <!-- Step 3: Business Details -->
        <div class="form-screen" id="businessScreen">
            <div class="progress-bar">
                <div class="progress-fill" style="width: 100%"></div>
            </div>
            <div class="form-header">
                <h2 class="form-title">Business Details</h2>
                <p class="form-subtitle">Final step - tell us about your business metrics</p>
            </div>

            <form id="businessForm">
                <div class="form-group">
                    <label class="form-label">Company Valuation (USD)</label>
                    <input type="number" class="form-input" id="valuation" placeholder="e.g., 1000000">
                </div>

                <div class="form-group">
                    <label class="form-label">What Does Your Company Do? <span class="required">*</span></label>
                    <textarea class="form-textarea" id="companyDescription" placeholder="Describe your product/service and value proposition" required></textarea>
                    <div class="error-message" id="descriptionError">Description is required</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Current Revenue (USD)</label>
                    <input type="number" class="form-input" id="revenue" placeholder="0">
                </div>

                <div class="form-group">
                    <label class="form-label">User Count</label>
                    <input type="number" class="form-input" id="userCount" placeholder="0">
                </div>

                <div class="form-group">
                    <label class="form-label">Monetization Idea <span class="required">*</span></label>
                    <textarea class="form-textarea" id="monetization" placeholder="How do you plan to make money?" required></textarea>
                    <div class="error-message" id="monetizationError">Monetization idea is required</div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="goToStartup()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="completeSetup()">Complete Setup</button>
                </div>
            </form>
        </div>

        <!-- Completion Screen -->
        <div class="completion-screen" id="completionScreen">
            <div class="success-icon">‚úì</div>
            <h2 class="completion-title">Your Startup Profile is Complete!</h2>
            <p class="completion-text">Ready to get started in ScaleStartup by creating your first vest?</p>
            <button class="start-btn" onclick="createFirstVest()">Create First Vest</button>
        </div>

        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="margin-top: 20px; color: #888;">Saving your information...</p>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        let currentUser = null;
        let cofoundersData = [];
        let logoFile = null;


        function startConfiguration() {
            document.getElementById('welcomeScreen').classList.remove('active');
            document.getElementById('founderScreen').classList.add('active');
        }

        function goToWelcome() {
            document.getElementById('founderScreen').classList.remove('active');
            document.getElementById('welcomeScreen').classList.add('active');
        }

        function goToFounder() {
            document.getElementById('startupScreen').classList.remove('active');
            document.getElementById('founderScreen').classList.add('active');
        }

        function goToStartup() {
            document.getElementById('businessScreen').classList.remove('active');
            document.getElementById('startupScreen').classList.add('active');
        }

        // Co-founder Management
        function addCofounder() {
            const container = document.getElementById('cofoundersContainer');
            const index = cofoundersData.length;
            
            const cofounderDiv = document.createElement('div');
            cofounderDiv.className = 'cofounder-item';
            cofounderDiv.innerHTML = `
                <div class="cofounder-header">
                    <div class="cofounder-title">Co-Founder ${index + 1}</div>
                    <button type="button" class="remove-btn" onclick="removeCofounder(${index})">Remove</button>
                </div>
                <div class="form-group">
                    <label class="form-label">Name <span class="required">*</span></label>
                    <input type="text" class="form-input" id="cofounderName${index}" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email <span class="required">*</span></label>
                    <input type="email" class="form-input" id="cofounderEmail${index}" placeholder="email@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Age <span class="required">*</span></label>
                    <input type="number" class="form-input" id="cofounderAge${index}" placeholder="25" required>
                </div>
            `;
            
            container.appendChild(cofounderDiv);
            cofoundersData.push({ index });
        }

        function removeCofounder(index) {
            cofoundersData = cofoundersData.filter(cf => cf.index !== index);
            renderCofounders();
        }

        function renderCofounders() {
            const container = document.getElementById('cofoundersContainer');
            container.innerHTML = '';
            cofoundersData.forEach((cf, idx) => {
                const cofounderDiv = document.createElement('div');
                cofounderDiv.className = 'cofounder-item';
                cofounderDiv.innerHTML = `
                    <div class="cofounder-header">
                        <div class="cofounder-title">Co-Founder ${idx + 1}</div>
                        <button type="button" class="remove-btn" onclick="removeCofounder(${cf.index})">Remove</button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Name <span class="required">*</span></label>
                        <input type="text" class="form-input" id="cofounderName${cf.index}" placeholder="Full Name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email <span class="required">*</span></label>
                        <input type="email" class="form-input" id="cofounderEmail${cf.index}" placeholder="email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Age <span class="required">*</span></label>
                        <input type="number" class="form-input" id="cofounderAge${cf.index}" placeholder="25" required>
                    </div>
                `;
                container.appendChild(cofounderDiv);
            });
        }

        // Logo Preview
        function previewLogo(event) {
            const file = event.target.files[0];
            if (file) {
                logoFile = file;
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('logoPreview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Logo Preview">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Validation
        function validateFounderForm() {
            let isValid = true;
            const fields = ['location', 'languages', 'userAge', 'graduation', 'experience'];
            
            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(field + 'Error');
                
                if (!input.value.trim()) {
                    error.classList.add('show');
                    isValid = false;
                } else {
                    error.classList.remove('show');
                }
            });

            return isValid;
        }

        function validateStartupForm() {
            let isValid = true;
            const fields = ['startupName', 'yearEstablished', 'country', 'state', 'city', 'category', 'stage'];
            
            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(field + 'Error');
                
                if (!input.value.trim()) {
                    error.classList.add('show');
                    isValid = false;
                } else {
                    error.classList.remove('show');
                }
            });

            return isValid;
        }

        function validateBusinessForm() {
            let isValid = true;
            const fields = ['companyDescription', 'monetization'];
            
            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(field + 'Error');
                
                if (!input.value.trim()) {
                    error.classList.add('show');
                    isValid = false;
                } else {
                    error.classList.remove('show');
                }
            });

            return isValid;
        }

        // Save Founder Details
        async function saveFounderDetails() {
            if (!validateFounderForm()) {
                return;
            }

            const cofounders = [];
            for (let cf of cofoundersData) {
                const name = document.getElementById(`cofounderName${cf.index}`).value;
                const email = document.getElementById(`cofounderEmail${cf.index}`).value;
                const age = document.getElementById(`cofounderAge${cf.index}`).value;
                
                if (name && email && age) {
                    cofounders.push({ name, email, age: parseInt(age) });
                }
            }

            const founderData = {
                location: document.getElementById('location').value,
                languages: document.getElementById('languages').value,
                age: parseInt(document.getElementById('userAge').value),
                graduation: document.getElementById('graduation').value,
                awards: document.getElementById('awards').value,
                experience: document.getElementById('experience').value,
                cofounders: cofounders,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };

            try {
                document.getElementById('loading').style.display = 'block';
                
                await db.collection('scalestartup')
                    .doc('founderprofile')
                    .collection('users')
                    .doc(currentUser.uid)
                    .set(founderData);

                document.getElementById('loading').style.display = 'none';
                document.getElementById('founderScreen').classList.remove('active');
                document.getElementById('startupScreen').classList.add('active');
            } catch (error) {
                console.error('Error saving founder details:', error);
                alert('Error saving data. Please try again.');
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Save Startup Profile
        async function saveStartupProfile() {
            if (!validateStartupForm()) {
                return;
            }

            document.getElementById('loading').style.display = 'block';

            try {
                let logoUrl = '';
                
                if (logoFile) {
                    const storageRef = storage.ref(`startup-logos/${currentUser.uid}/${Date.now()}_${logoFile.name}`);
                    const snapshot = await storageRef.put(logoFile);
                    logoUrl = await snapshot.ref.getDownloadURL();
                }

                const startupData = {
                    startupName: document.getElementById('startupName').value,
                    yearEstablished: parseInt(document.getElementById('yearEstablished').value),
                    location: {
                        country: document.getElementById('country').value,
                        state: document.getElementById('state').value,
                        city: document.getElementById('city').value
                    },
                    logo: logoUrl,
                    category: document.getElementById('category').value,
                    stage: document.getElementById('stage').value,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('scalestartup')
                    .doc('startupprofile')
                    .collection('users')
                    .doc(currentUser.uid)
                    .set(startupData, { merge: true });

                document.getElementById('loading').style.display = 'none';
                document.getElementById('startupScreen').classList.remove('active');
                document.getElementById('businessScreen').classList.add('active');
            } catch (error) {
                console.error('Error saving startup profile:', error);
                alert('Error saving data. Please try again.');
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Complete Setup
        async function completeSetup() {
            if (!validateBusinessForm()) {
                return;
            }

            document.getElementById('loading').style.display = 'block';

            try {
                const businessData = {
                    valuation: parseFloat(document.getElementById('valuation').value) || 0,
                    companyDescription: document.getElementById('companyDescription').value,
                    revenue: parseFloat(document.getElementById('revenue').value) || 0,
                    userCount: parseInt(document.getElementById('userCount').value) || 0,
                    monetization: document.getElementById('monetization').value,
                    setupCompleted: true,
                    completedAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('scalestartup')
                    .doc('startupprofile')
                    .collection('users')
                    .doc(currentUser.uid)
                    .set(businessData, { merge: true });

                document.getElementById('loading').style.display = 'none';
                document.getElementById('businessScreen').classList.remove('active');
                document.getElementById('completionScreen').classList.add('active');
            } catch (error) {
                console.error('Error completing setup:', error);
                alert('Error saving data. Please try again.');
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Create First Vest
        function createFirstVest() {
            window.location.href = 'vests.html';
        }
    </script>
</body>
</html>
